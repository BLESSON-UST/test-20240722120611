Sorry, but you haven't provided any code for me to analyze and upgrade. Could you please provide the code you want me to work on?